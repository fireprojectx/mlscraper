<script>
  async function consultar() {
    const link = document.getElementById("linkInput").value;
    const resultado = document.getElementById("resultado");
    resultado.innerHTML = "Consultando...";

    try {
      const res = await fetch(`/scrape/?url=${encodeURIComponent(link)}`);
      if (!res.ok) throw new Error(`Erro ${res.status}`);
      const data = await res.json();

      if (data.Erro) {
        resultado.innerHTML = `<span class="text-red-600">${data.Erro}</span>`;
        return;
      }

      resultado.innerHTML = `
        <div><strong>Título:</strong> ${data.Título || "N/A"}</div>
        <div><strong>Preço:</strong> ${data.Preço || "N/A"}</div>
        <div><strong>Vendidos:</strong> ${data.Vendidos || "N/A"}</div>
        <div><strong>Data do Anúncio:</strong> ${data.DataInicio || "N/A"}</div>
      `;
    } catch (err) {
      console.error(err);
      resultado.innerHTML = `<span class="text-red-600">Erro: ${err.message}</span>`;
    }
  }
</script>

<script>
  async function consultar() {
    const link = document.getElementById("linkInput").value;
    const resultado = document.getElementById("resultado");
    resultado.innerHTML = "Consultando...";

    try {
      const res = await fetch(`/scrape/?url=${encodeURIComponent(link)}`);
      if (!res.ok) throw new Error(`Erro ${res.status}`);
      const data = await res.json();

      resultado.innerHTML = `
        <div><strong>Preço:</strong> R$ ${data.price || "N/A"}</div>
        <div><strong>Estoque:</strong> ${data.stock || "N/A"}</div>
        <div><strong>Vendas:</strong> ${data.sales || "N/A"}</div>
        <div><strong>Data do Anúncio:</strong> ${data.start_time || "N/A"}</div>
      `;
    } catch (err) {
      console.error(err);
      resultado.innerHTML = `<span class="text-red-600">Erro: ${err.message}</span>`;
    }
  }
</script>
